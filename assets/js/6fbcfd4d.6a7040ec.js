"use strict";(self.webpackChunkstarcoin_cookbook=self.webpackChunkstarcoin_cookbook||[]).push([[3158],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var l=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,l,r=function(e,t){if(null==e)return{};var n,l,r={},a=Object.keys(e);for(l=0;l<a.length;l++)n=a[l],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(l=0;l<a.length;l++)n=a[l],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=l.createContext({}),u=function(e){var t=l.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=u(e.components);return l.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return l.createElement(l.Fragment,{},t)}},d=l.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,g=d["".concat(s,".").concat(m)]||d[m]||c[m]||a;return n?l.createElement(g,o(o({ref:t},p),{},{components:n})):l.createElement(g,o({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var u=2;u<a;u++)o[u]=n[u];return l.createElement.apply(null,o)}return l.createElement.apply(null,n)}d.displayName="MDXCreateElement"},68:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return o},default:function(){return c},frontMatter:function(){return a},metadata:function(){return i},toc:function(){return u}});var l=n(3117),r=(n(7294),n(3905));const a={},o="Building Starcoin from source",i={unversionedId:"getting-started/install/build",id:"getting-started/install/build",title:"Building Starcoin from source",description:"Quick start",source:"@site/docs/02-getting-started/01-install/01-build.md",sourceDirName:"02-getting-started/01-install",slug:"/getting-started/install/build",permalink:"/docs/getting-started/install/build",draft:!1,editUrl:"https://github.com/starcoinorg/starcoin-cookbook/edit/main/docs/02-getting-started/01-install/01-build.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Download and Install",permalink:"/docs/getting-started/install/"},next:{title:"Install by docker",permalink:"/docs/getting-started/install/install-by-docker"}},s={},u=[{value:"Quick start",id:"quick-start",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Windows",id:"windows",level:3},{value:"WSL",id:"wsl",level:3},{value:"Q1:",id:"q1",level:4},{value:"Q2:",id:"q2",level:4},{value:"CentOS",id:"centos",level:3},{value:"Common troubleshooting",id:"common-troubleshooting",level:3},{value:"Q1:",id:"q1-1",level:4},{value:"Q2:",id:"q2-1",level:4},{value:"GitHub network issue",id:"github-network-issue",level:3}],p={toc:u};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,l.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"building-starcoin-from-source"},"Building Starcoin from source"),(0,r.kt)("h2",{id:"quick-start"},"Quick start"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Clone the source code to local")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/starcoinorg/starcoin.git\ncd starcoin\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Setup build environment")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"./scripts/dev_setup.sh\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Buid with Cargo")),(0,r.kt)("p",null,"Note: Two versions (debug, release) of build methods are provided here, the debug version is used in the development environment, and the release version is used in the production environment."),(0,r.kt)("p",null,"If you want to use it formally, use the release version, there is an order of magnitude difference in performance between the debug version and the release version."),(0,r.kt)("p",null,"(1) Build the debug version"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cargo build\n")),(0,r.kt)("p",null,"(2) Build the release version"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cargo build --release\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Target file")),(0,r.kt)("p",null,"After compiling, you can find the corresponding starcoin program in the target directory."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The debug version is in the ",(0,r.kt)("inlineCode",{parentName:"li"},"target/debug/starcoin")," directory"),(0,r.kt)("li",{parentName:"ul"},"The release version is in the ",(0,r.kt)("inlineCode",{parentName:"li"},"target/release/starcoin")," directoryg")),(0,r.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,r.kt)("h3",{id:"windows"},"Windows"),(0,r.kt)("p",null,"If the following error information appears during the compilation process in Windows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"'Unable to find libclang: \"couldn't find any valid shared libraries matching: ['clang.dll', 'libclang.dll'], set the `LIBCLANG_PATH` environment variable to a path where one of these files can be found (invalid: [])\"'\n")),(0,r.kt)("p",null,"This is because the ",(0,r.kt)("inlineCode",{parentName:"p"},"LIBCLANG_PATH")," environment variable is not set."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solution:")),(0,r.kt)("p",null,"Set the value of ",(0,r.kt)("inlineCode",{parentName:"p"},"LIBCLANG_PATH")," to the ",(0,r.kt)("inlineCode",{parentName:"p"},"bin")," directory of LLVM compilation tool set."),(0,r.kt)("p",null,"Set according to your specific installation location, for example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"C:\\Program Files\\LLVM\\bin\n")),(0,r.kt)("h3",{id:"wsl"},"WSL"),(0,r.kt)("h4",{id:"q1"},"Q1:"),(0,r.kt)("p",null,"Compiling with WSL2 may give the following error message:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"error: linking with `cc` failed: exit status: 1\n")),(0,r.kt)("p",null,"This is because the swap memory of WSL2 is not set, or is less than the maximum memory of WSL2."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solution:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Open Windows Explorer, type ",(0,r.kt)("inlineCode",{parentName:"li"},"%UserProfile%")," in the address bar and hit enter."),(0,r.kt)("li",{parentName:"ul"},"Create a file in this directory named ",(0,r.kt)("inlineCode",{parentName:"li"},".wslconfig")),(0,r.kt)("li",{parentName:"ul"},"An example of the written content is as follows: (according to the actual allocation of your computer, make sure that swap is greater than or equal to memory)",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-config"},"[wsl2]\nmemory=2GB\nswap=4GB\n"))),(0,r.kt)("li",{parentName:"ul"},"Execute ",(0,r.kt)("inlineCode",{parentName:"li"},"wsl --shutdown")," in cmd to close WSL2, and then reopen it.")),(0,r.kt)("h4",{id:"q2"},"Q2:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Why do I compile for so long?")),(0,r.kt)("p",null,"This situation usually occurs on users with low computer configuration. Here are two feasible suggestions:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Upgrade computer configuration.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Controls the number of jobs Cargo compiles with."))),(0,r.kt)("p",null,"For low-profile machines, controlling the number of cores is the key to greatly improving compilation efficiency."),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cargo build -j 1\n")),(0,r.kt)("p",null,"For specific test cases, see the discussion in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/starcoinorg/starcoin-cookbook/issues/70"},"[bug] Excessive swap may result in slower builds #70"),"."),(0,r.kt)("h3",{id:"centos"},"CentOS"),(0,r.kt)("p",null,"If your operating system is ",(0,r.kt)("inlineCode",{parentName:"p"},"CentOS 6.x"),", then use such commands to install some toolsets."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"yum install centos-release-scl\nyum install devtoolset-7\n. /opt/rh/devtoolset-7/enable\n")),(0,r.kt)("h3",{id:"common-troubleshooting"},"Common troubleshooting"),(0,r.kt)("h4",{id:"q1-1"},"Q1:"),(0,r.kt)("p",null,"The following error message appears when compiling with Cargo:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"error: linker cc not found | = note: No such file or directory (os error 2)\n")),(0,r.kt)("p",null,"This is because Cargo cannot find the ",(0,r.kt)("inlineCode",{parentName:"p"},"cc")," compiler program (linker) to compile the given application."),(0,r.kt)("p",null,"Since Rust does not yet include its own linker, usually we need to install a C compiler, such as: compilation tools such as ",(0,r.kt)("inlineCode",{parentName:"p"},"gcc")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"cmake"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solution:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To install gcc on Ubuntu, simply run, ",(0,r.kt)("inlineCode",{parentName:"li"},"build-essential")," contains the basic toolset needed to compile and develop:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo apt install build-essential\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To install Cmake on Arch Linux, enable the ",(0,r.kt)("inlineCode",{parentName:"li"},"[Extra]")," repository and run:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo pacman -S gcc cmake\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"On Fedora, RHEL, CentOS:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo dnf install gcc cmake\n")),(0,r.kt)("h4",{id:"q2-1"},"Q2:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"If the error message ",(0,r.kt)("inlineCode",{parentName:"li"},"Could not find directory of OpenSSL installation")," appears, you need to install the OpenSSL library."),(0,r.kt)("li",{parentName:"ul"},"If the error ",(0,r.kt)("inlineCode",{parentName:"li"},'Unable to find libclang: "the `libclang` shared library at /usr/lib64/clang-private/libclang.so.6.0"')," appears, it may be the cause of ",(0,r.kt)("inlineCode",{parentName:"li"},"llvm-private"),". The solution is to uninstall it:",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'rpm qa | grep "llvm-private" # Find packages containing llvm-private\nrpm -e --nodeps llvm-private-6.0.1-2.el7.x86_64 # Uninstall found packages\n'))),(0,r.kt)("li",{parentName:"ul"},"After each compilation error, after solving, you need to ",(0,r.kt)("inlineCode",{parentName:"li"},"cargo clean"),", remove the previously compiled object files, and then recompile.")),(0,r.kt)("h3",{id:"github-network-issue"},"GitHub network issue"),(0,r.kt)("p",null,"If the following error message shows up at start of building:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"error: failed to get `xxx` as a dependency of package `...`\n...\n...\n  fatal: couldn't find remote ref HEAD\n")),(0,r.kt)("p",null,"You may need to set up a proxy server for ",(0,r.kt)("inlineCode",{parentName:"p"},"GitHub"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"git config --global http.https://github.com.proxy [protocol://][user[:password]@]proxyhost[:port]\n")))}c.isMDXComponent=!0}}]);